{% extends 'base.html' %}

{% block title %}–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h4 class="mb-0">üë• –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h4>
        <span class="badge bg-primary">{{ users|length }} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</span>
    </div>

    <div class="card-body">
        {% if users %}
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</th>
                        <th>Email</th>
                        <th>–†–æ–ª—å</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in users %}
                    <tr>
                        <td>{{ user.id }}</td>
                        <td>{{ user.username }}</td>
                        <td>{{ user.email }}</td>
                        <td>
                            <span class="badge {% if user.is_manager %}bg-info{% else %}bg-secondary{% endif %}">
                                {{ user.get_role_display }}
                            </span>
                        </td>
                        <td>
                            {% if user.is_blocked %}
                                <span class="badge bg-danger">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</span>
                            {% else %}
                                <span class="badge bg-success">–ê–∫—Ç–∏–≤–µ–Ω</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if user != request.user %}
                                <form method="post" action="{% url 'users:toggle_user_block' user.id %}" class="d-inline">
                                    {% csrf_token %}
                                    <button type="submit" class="btn btn-sm {% if user.is_blocked %}btn-success{% else %}btn-warning{% endif %}">
                                        {% if user.is_blocked %}–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å{% else %}–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å{% endif %}
                                    </button>
                                </form>
                            {% else %}
                                <span class="badge bg-info">–≠—Ç–æ –≤—ã</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="mt-3 text-muted small">
            –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {{ users|length }}
        </div>
        {% else %}
        <div class="alert alert-info">
            –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
